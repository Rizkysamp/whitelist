<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Whitelist | Millanium RP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .loader{border-top-color:#06b6d4;animation:spinner 1s linear infinite}@keyframes spinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
        #rulesModal,#mainPanel{display:none}
        body{background-color:#0a0f1a;user-select:none;-webkit-user-select:none;}
    </style>
</head>
<body class="text-white font-sans flex items-center justify-center min-h-screen p-4">

    <div id="loadingScreen" class="fixed inset-0 bg-slate-950 z-50 flex flex-col items-center justify-center">
        <div class="loader ease-linear rounded-full border-2 border-t-2 border-slate-800 h-10 w-10 mb-4"></div>
        <p class="text-cyan-500 font-bold tracking-[0.3em] text-[10px] uppercase animate-pulse">System Initializing...</p>
    </div>

    <div id="rulesModal" class="fixed inset-0 z-40 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
        <div class="bg-slate-900 border border-slate-800 w-full max-w-sm rounded-3xl p-8 shadow-2xl border-t-2 border-t-cyan-600">
            <h2 class="text-lg font-black uppercase text-center mb-6">Security Access</h2>
            <div class="space-y-3 text-[12px] text-slate-400 mb-8 border-l-2 border-cyan-600 pl-4">
                <p>• Gunakan format Nama_Belakang.</p>
                <p>• Dilarang keras melakukan bypass sistem.</p>
                <p>• Segala aktivitas tercatat secara otomatis.</p>
            </div>
            <button onclick="acceptRules()" class="w-full bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-4 rounded-2xl transition-all active:scale-95 text-[11px] tracking-widest uppercase">
                Authorize Identity
            </button>
        </div>
    </div>

    <div id="mainPanel" class="max-w-sm w-full p-8 bg-slate-900 rounded-[2.5rem] shadow-2xl border border-slate-800 relative">
        <div class="text-center mb-8">
            <h1 class="text-xl font-black italic text-cyan-500">MILLANIUM RP</h1>
            <p class="text-slate-500 text-[9px] uppercase tracking-[0.4em] mt-1">Whitelist Terminal</p>
        </div>

        <div class="space-y-4">
            <input type="text" id="playerName" class="w-full px-5 py-4 bg-slate-800 border-none rounded-2xl focus:ring-2 focus:ring-cyan-500/50 outline-none transition-all text-sm text-white font-mono" placeholder="NAME_IDENTITY">
            <button onclick="submitWhitelist()" id="btnSubmit" class="w-full bg-white text-black font-black py-4 rounded-2xl transition-all flex items-center justify-center text-[10px] tracking-[0.1em] uppercase active:scale-95">
                <span id="btnText">Execute Sync</span>
            </button>
        </div>

        <div id="statusBox" class="mt-4 hidden p-4 rounded-2xl text-[10px] font-mono text-center border border-slate-800 bg-black/20"></div>

        <div class="mt-8 pt-6 border-t border-slate-800/50 text-center">
            <p class="text-[9px] text-slate-600 font-bold tracking-widest uppercase">IP: 159.223.83.82:5163</p>
        </div>
    </div>

    <script>
        // Versi ini menggunakan Base64 untuk proteksi agar browser tidak bingung
        const _s = (b) => atob(b);

        // Fungsi Penampil Elemen (Dienkripsi)
        function init() {
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('rulesModal').style.display = 'flex';
            }, 1500);
        }

        // Jalankan saat siap
        if (document.readyState === 'complete') { init(); } 
        else { window.addEventListener('load', init); }

        function acceptRules() {
            document.getElementById('rulesModal').style.display = 'none';
            document.getElementById('mainPanel').style.display = 'block';
            const saved = localStorage.getItem('myWhitelist');
            if(saved) {
                showStatus("MATCH FOUND: " + saved, "border-cyan-500/30 text-cyan-400");
                disableButton();
            }
        }

        async function submitWhitelist() {
            const input = document.getElementById('playerName');
            const name = input.value.trim();
            const btn = document.getElementById('btnSubmit');
            const txt = document.getElementById('btnText');

            if(localStorage.getItem('myWhitelist')) return alert("DEVICE_SYNC_LOCKED");
            if(!name.includes("_")) return showStatus("ERROR: FORMAT_INVALID", "border-red-500/30 text-red-400");

            btn.disabled = true;
            txt.innerText = "PROCESSING...";

            try {
                // Logika API (Hanya bagian URL yang disembunyikan agar tidak mudah diganti)
                const _u = _s('L2FwaS93aGl0ZWxpc3Q='); // /api/whitelist
                const res = await fetch(_u, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({name: name})
                });
                const data = await res.json();

                if(data.success) {
                    localStorage.setItem('myWhitelist', name);
                    showStatus("SYNC SUCCESSFUL: " + name, "border-green-500/30 text-green-400");
                    disableButton();
                } else {
                    showStatus("REJECTED: " + (data.error || "UNKNOWN"), "border-red-500/30 text-red-400");
                    btn.disabled = false;
                    txt.innerText = "Execute Sync";
                }
            } catch(e) {
                showStatus("NETWORK_CONNECTION_ERROR", "border-red-500/30 text-red-400");
                btn.disabled = false;
                txt.innerText = "Execute Sync";
            }
        }

        function disableButton() {
            const b = document.getElementById('btnSubmit');
            b.disabled = true;
            b.classList.add('opacity-30', 'grayscale');
            document.getElementById('btnText').innerText = "AUTHORIZED";
        }

        function showStatus(m, c) {
            const s = document.getElementById('statusBox');
            s.innerText = m;
            s.className = "mt-4 p-4 rounded-2xl text-[10px] font-mono text-center border " + c;
            s.classList.remove('hidden');
        }

        // Anti Klik Kanan
        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>
</html>
